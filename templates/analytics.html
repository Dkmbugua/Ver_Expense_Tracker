<!DOCTYPE html>
<html>
<head>
    <title>Analytics</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
         body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
            background-color: #f9f9f9;
        }
        h1 {
            font-size: 24px;
            margin: 20px 0;
        }
        .charts-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            margin-top: 20px;
        }
        .chart {
            width: 45%;
            margin: 10px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            h1 {
                font-size: 20px;
            }
            .charts-container {
                flex-direction: column;
                align-items: center;
            }
            .chart {
                width: 90%;
                margin: 10px 0;
            }
        }
    </style>
</head>
<body>
    <h1>Financial Analytics Dashboard</h1>

    <!-- Pie Chart for Expense Distribution -->
    <div id="pie-chart" class="chart"></div>

    <!-- Bar Chart for Income vs Expenses -->
    <div id="bar-chart" class="chart"></div>

    <!-- Line Chart for Savings Growth -->
    <div id="line-chart" class="chart"></div>

    <a href="/">Back to Home</a>

    <!-- Script for the Charts -->
    <script>
        // Data for Pie Chart (Expense Distribution)
        var pieData = [{
            labels: {{ categories | default([]) | tojson }},
            values: {{ expenses_by_category | default([]) | tojson }},
            type: 'pie',
            hole: 0.4,
            textinfo: 'label+percent',
            hoverinfo: 'label+value'
        }];

        var pieLayout = {
            title: 'Expense Distribution by Category',
        };

        Plotly.newPlot('pie-chart', pieData, pieLayout);

        // Data for Bar Chart (Income vs Expenses)
        var barData = [
            {
                x: {{ months_expenses | default([]) | tojson }},
                y: {{ expense_values | default([]) | tojson }},
                name: 'Expenses',
                type: 'bar',
                marker: { color: 'rgba(222, 45, 38, 0.8)' }
            },
            {
                x: {{ months_incomes | default([]) | tojson }},
                y: {{ income_values | default([]) | tojson }},
                name: 'Incomes',
                type: 'bar',
                marker: { color: 'rgba(55, 128, 191, 0.8)' }
            }
        ];

        var barLayout = {
            title: 'Monthly Income vs Expenses',
            barmode: 'group',
            xaxis: { title: 'Months' },
            yaxis: { title: 'Amount' }
        };

        Plotly.newPlot('bar-chart', barData, barLayout);

        // Data for Line Chart (Savings Growth)
        var lineData = [{
            x: {{ months_expenses | default([]) | tojson }},
            y: {{ savings | default([]) | tojson }},
            type: 'scatter',
            mode: 'lines+markers',
            line: { shape: 'spline', color: 'green' },
            name: 'Savings'
        }];

        var lineLayout = {
            title: 'Savings Growth Over Time',
            xaxis: { title: 'Months' },
            yaxis: { title: 'Savings (Amount)' }
        };

        Plotly.newPlot('line-chart', lineData, lineLayout);
    </script>
</body>
</html>
